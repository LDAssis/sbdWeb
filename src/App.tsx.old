import React from "react";
import "./App.css";
import Layout, { Content, Footer, Header } from "antd/lib/layout/layout";
import { Input, Menu } from "antd";
import { useState } from "react";
import TextArea from "antd/lib/input/TextArea";

const { Search } = Input;

async function App() {
  let [query, setQuery] = useState<string>();
  let [response, setResponse] = useState({
    temp_process: Number(),
    resultados_qtd: Number(),
    query: String(),
    resultados: [],
  });

  function handleChangeQuery(e: React.ChangeEvent<HTMLInputElement>) {
    setQuery(e.target.value);
  }

  function doRequest() {
    const requestOptions = {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Access-Control-Allow-Origin": "*",
      },
      body: JSON.stringify({ query: query }),
    };

    fetch("http://127.0.0.1:8080/Selects", requestOptions)
      .then((response) => response.json())
      .then((data) => setResponse(data));

    console.log(response.temp_process);
    console.log(JSON.stringify({ query: query }));
  }

  return (
    <Layout className="layout">
      <Header>
        <div className="logo" />
        <Menu
          style={{
            alignContent: "center",
          }}
          theme="dark"
          mode="horizontal"
          defaultSelectedKeys={["2"]}
        >
          <Search
            placeholder="input search text"
            onChange={handleChangeQuery}
            onSearch={doRequest}
            enterButton
          />
        </Menu>
      </Header>
      <Content style={{ padding: "0 50px" }}>
        <TextArea value={typeof response} />
      </Content>
      <Footer style={{ textAlign: "center" }}>
        Ant Design Â©2018 Created by Ant UED
      </Footer>
    </Layout>
  );
}

export default App;
